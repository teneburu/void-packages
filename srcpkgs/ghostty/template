# Template file for 'ghostty'
pkgname=ghostty
version=1.3.0
revision=1
build_style=zig-build
configure_args="
 -Doptimize=ReleaseFast
 -Dpie
 -Dversion-string=${version}
 -fsys=freetype
 -fsys=fontconfig
 -fsys=harfbuzz"
hostmakedepends="pkg-config glib-devel pandoc"
makedepends="fontconfig-devel freetype-devel harfbuzz-devel gtk4-devel libadwaita-devel"
depends="ghostty-terminfo-${version}_${revision}"
short_desc="Fast and feature-rich terminal emulator that uses GPU acceleration"
maintainer="teneburu <teneburu@proton.me"
license="MIT"
homepage="https://ghostty.org/"
distfiles="https://github.com/ghostty-org/ghostty/releases/download/tip/ghostty-source.tar.gz"
checksum=9b8d97a74f9b2bf695a9e262c38d2a3aaf90d4935fb8dbe7b31698ce2c952209


case "${XBPS_TARGET_MACHINE}" in
	armv*) broken="src/apprt/gtk/cgroup.zig:70:14: error: expected type 'usize', found 'u64'" ;;
esac


post_install() {
	vlicense LICENSE
	rm -f ${DESTDIR}/usr/share/man/.placeholder
}

ghostty-terminfo_package() {
	short_desc+=" - terminfo data"
	pkg_install() {
		vmove usr/share/terminfo
	}
}
